language: c
dist: bionic
before_install:
  - travis_retry sudo apt-get -y -qq update
  - travis_retry sudo apt-get -y install octave
  - travis_retry sudo apt-get -y install liboctave-dev
install:
  # Install JSONio
  - travis_retry git clone git://github.com/gllmflndn/JSONio.git --depth 1
  - cd JSONio; mkoctfile jsonread.c jsmn.c -DJSMN_PARENT_LINKS; cd ..
  - octave --eval "addpath (fullfile (pwd, 'JSONio')); savepath ();"
  # Install bids/matlab
  - octave --eval "addpath (pwd); savepath ();"
  # Fix for namespaces containing private directories in Octave
  - octave --eval "addpath (fullfile (pwd, '+bids')); savepath ();"
script:
  - octave --version
  - octave --eval "path ()"
  - octave --eval "bids.util.jsondecode (fullfile (pwd, 'tests', 'data', 'MoAEpilot', 'dataset_description.json'))"
  - octave --eval "bids.layout (fullfile (pwd, 'tests', 'data', 'MoAEpilot'))"
