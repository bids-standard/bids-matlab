---
title: "BIDS-matlab: How to read the data from the BIDS dataset"
tags:
  - MATLAB
  - Octave
  - brain imaging data structure
  - MRI
  - MEG
  - EEG
  - iEEG
  - PET
  - microscopy
authors:
  - name: Rémi Gau
    orcid: 0000-0002-1535-9767
    affiliation: 1
  - name: Marco Barilari
    orcid: 0000-0002-3313-3120
    affiliation: 1
  - name: Ceren Battal
    orcid: 0000-0002-9844-7630
    affiliation: 1
  - name: Nikita Beliy
  - name: Rotem  Botvinik-Nezer
  - name: Jeanne Caron-Guyon
    orcid: 0000-0001-8681-5267
    affiliation: 1
  - name: Phillips Chrisophe
    orcid: 0000-0002-4990-425X
  - name: Tanguy Duval
    orcid: 0000-0002-1228-5192
  - name: Guillaume Flandin
    orcid: 0000-0003-0077-7859
  - name: Andrew Janke
  - name: Michèle MacLean
    orcid: 0000-0002-0174-9326
    affiliation: 2
  - name: Christopher Madan
    orcid: 0000-0003-3228-6501
  - name: Henk Mutsaerts
    orcid: 0000-0003-0894-0307
  - name: Guiomar Niso
    orcid: 0000-0001-5872-8924
  - name: Martin Norgaard
    orcid: 0000-0003-2131-5688
  - name: Robert Oostenveld
    orcid: 0000-0002-1974-1293
  - name: Cyril Pernet
    orcid: 0000-0003-4010-4632
  - name: Iqra Shahzad
    orcid: 0000-0002-8724-7668
    affiliation: 1
  - name: Michał Szczepanik
    orcid: 0000-0002-4028-2087
affiliations:
  - name: Université catholique de Louvain
    index: 1
  - name: Université de Montréal
    index: 2
date: '2022-10-21'
bibliography: paper.bib
---

Word count: `r wordcountaddin::word_count()`

# Summary

The brain imaging data structure (BIDS) [@gorgolewski_brain_2016]
is becoming the standard for organizing "neuroimaging" data.

BIDS-matlab aims at centralizing MATLAB/Octave tools to interact with BIDS datasets.

# Statement of need

The brain imaging data structure (BIDS) [@gorgolewski_brain_2016]
is becoming the standard for organizing data in neuroscience
for several types of imaging modalites
(magnetic resonance imaging, positron emission tomography, microscopy...).

There currently is a python package (pybids, @yarkoni_pybids_2019)
that "includes virtually any functionality that is likely to be of general use
when working with BIDS datasets (i.e., that is not specific to one narrow context)".

<!-- Menton ANCPBIDS -->

There are also several MATLAB toolboxes (EEGlab `REF_NEEDED`, CONN toolbox `REF_NEEDED`)
have some BIDS support, at least to the extend that they can ingest
raw and/or derivatives BIDS datasets.

<!-- Resting state tooboxes -->

But there is no common library that, independently of the imaging modality:
- can index and query data and metadata BIDS dataset (whether they are raw or derivatives datasets)
- helps easily create filenames that follow a BIDS pattern
- can interact with the BIDS schema
- implements several of transformers to help using the BIDS statistical models
- can work for both MATLAB and Octave.

BIDS-matlab aims to fill that gap.


# Features

At the moment of the writing of this article, BIDS-matlab has the main following features.

## Indexing and querying datasets

When a dataset has several dozens of participants with heterogeneous content
in terms of imaging modality or acquisition parameters and
with metadata for even a single data file potentially spread across several JSON files,
it can become difficult to fetch the right file or piece of metadata.

BIDS-matlab can:

- return the layout of a BIDS dataset (`bids.layout`),

- perform queries on that layout to get information about the subjects,
  sessions, runs, modalities, metadata... contained within that dataset (`bids.query`).

BIDS-matlab is able to parse files in a BIDS datasets whether they follow the BIDS schema
or not, but require that they follow typical BIDS filenaming patterns (like those
generated by fMRIprep [@esteban_fmriprep_2019] -
see [next section](#creating-bids-valid-filenames) for more details).

One notable extension was made to this filename parsing rule to accommodate filenames
that include a prefix before the standard BIDS filename
(for example `swuasub-01_task-rest_bold.nii` with the prefix `swua`)
as prefixing is such a common way to deal with derivatives filenames.

## Creating BIDS valid filenames

Most files in a BIDS dataset follow a standard naming convention that can be summarised as follow:

```bash
datatype/sub-subLabel(_entity-label)*_suffix\.ext
```
<!-- test pseudo regex above and add link and example  -->

As of this writing, the BIDS specification supports:

- 12 datatypes (for example: `func`, `anat`, `eeg`...)
- 28 different entities (for example: `ses`, `task`, `acq`...)
- 103 suffixes (for example: `bold`, `T1w`, `events`...)

BIDS has a strict set of rules regarding:
- which suffix and entities are allowed for each datatype,
- which entities are allowed for raw and derivatives data,
- which entities are required or optional for each datatype and suffix,
- which order entities should appear in a filename.

Creating BIDS valid filenames can therefore become a tedious task.
BIDS-matlab `bids.File` class can help by relying on the BIDS schema
to validate filenames upon creation.

## transformers


## Dataset summaries

- generate a human readable report of the content of BIDS data set containing
  anatomical MRI, functional MRI, diffusion weighted imaging, field map data
  (see `bids.report`)

- create summary figures listing the number of files for each subject / session and
  and imaging modality (see `bids.diagnostic`)

![Multisubject dataset content split by task.\label{fig:example}](../source/images/MultisubjectMultimodalFaceProcessing_splitby-task.png){ width=100% }

- access and query the [BIDS schema](https://bids-specification.readthedocs.io/en/latest/schema.json) (`bids.schema`)

- access, query and create basic transformations for the [BIDS statistical model](https://bids-standard.github.io/stats-models/) (`bids.Model` and `bids.transformers`)

The behavior of this toolbox assumes that it is interacting with a valid BIDS
dataset that should have been validated using
[BIDS-validator](https://bids-standard.github.io/bids-validator/).

## Usage

According to a recent survey of 283 scientist [@paret_survey_2022],
7% of the 101 ones that had used BIDS before had also used BIDS-matlab.

BIDS-matlab is currently used in ASL explore [@mutsaerts_exploreasl_2020] and BIDSpm [@BIDSpm].

## Performance

## Development

- linting
- testing
- pre-commit

# Acknowledgements

# References
